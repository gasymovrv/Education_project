# Регулярные выражения

## Метасимволы

1. Метасимволы для поиска совпадений границ строк или текста
    + ```^```   начало строки
    + ```$```   конец строки
    + ```\b```	граница слова (слова - это несколько символов ```\w```)
    + ```\B```	не граница слова
    + ```\A```	начало ввода
    + ```\G```	конец предыдущего совпадения
    + ```\Z```	конец ввода
    + ```\z```	конец ввода

2. Метасимволы для поиска символьных классов
    + ```\d```	цифры = ```[0-9]```
    + ```\D```	не-цифры = ```[^0-9]```
    + ```\s```	пробельные символы, переводы строки = ```[\t\n\v\f\r ]``` плюс несколько юникодных пробельных символов
    + ```\S```	всё, кроме \s = ```[^\s]```
    + ```\w```	латинница, цифры, подчёркивание = ```[a-zA-Z0-9_]```
    + ```\W```	всё, кроме \w = ```[^a-zA-Z0-9_]```
    + ```.```   любой символ, кроме перевода строки

3. Метасимволы для поиска символов редактирования текста
    + ```\t```      символ табуляции
    + ```\n```      символ новой строки
    + ```\r```      символ возврата каретки
    + ```\f```      переход на новую страницу
    + ```\u 0085``` символ следующей строки
    + ```\u 2028``` символ разделения строк
    + ```\u 2029``` символ разделения абзацев

4. Метасимволы для группировки символов
    + ```[абв]```	    любой из перечисленных (а,б, или в)
    + ```[^абв]```	    любой, кроме перечисленных (не а,б, в)
    + ```[a-zA-Z]```	слияние диапазонов (латинские символы от a до z без учета регистра )
    + ```[a-d[m-p]]```	    объединение символов (от a до d и от m до p)
    + ```[a-z&&[def]]```	пересечение символов (символы d,e,f)
    + ```[a-z&&[^bc]]```	вычитание символов (символы a, d-z)
    + В квадратных скобках без экранирования можно использовать символы:
        + Точка '.'.
        + Плюс '+'.
        + Круглые скобки '( )'.
        + Дефис '-', если он находится в начале или конце квадратных скобок, то есть не выделяет диапазон.
        + Символ каретки '^', если не находится в начале квадратных скобок.
        + А также открывающая квадратная скобка '['.

5. Метасимволы для обозначения количества символов – **квантификаторы**. Квантификатор всегда следует после символа или группы символов.
    + ```?```	один или отсутствует
    + ```*```	ноль или более раз
    + ```+```	один или более раз
    + ```{n}```     n раз
    + ```{n,}```    n раз и более
    + ```{n,m}```	не менее n раз и не более m раз

6. Скобочные группы
    + ```()``` - заключение части шаблона в группу дает доп. эффекты:
        + ```()+``` - группа символов (или вложенный шаблон) повторяются 1 и более раз
        + ```\n```,```$n``` - обратные ссылки для обращения к группам и использования их при замене:
        ```java
        String wordsEng = "This test test is is";
        wordsEng.replaceAll("(\\w+)(\\s+)(\\b\\1\\b)", "$1$2<strong>$3</strong>");
        ```
        ```javascript
        var str = 'This test test is is';
        lg(str.replace(/(\w+)(\s+)(\1)/gi, '$1$2<strong>$3</strong>'));
        ```
        + ```(?:\w)``` - скобочную группу можно исключить из запоминаемых и нумеруемых, добавив в её начало ```?:```
    + ```(cat|кот)``` - Альтернация - выбор между несколькими вариантами слов
    + Опережающие проверки (Предпросмотр)
        + ```(?!cat|кот)``` - Отрицательный предпросмотр означает: 
        если выражение ```cat``` или ```кот``` не соответствует данной позиции, 
        сравнить остаток шаблона; если обнаружено соответствие ```сat[остаток шаблона]```, то весь шаблон нам не подходит. 
        + ```(?=...)``` - Положительная проверка. 
        Соответствует случаю, когда содержащееся выражение, представленное здесь как ```...```, соответствует текущей позиции. 
        Но, после того как содержащееся выражение было опробовано, сравнивающий движок не продвигается далее
## Режимы квантификаторов

+ **Жадный режим** - ищет максимально длинное совпадение в строке.
    + Пример поиска в строке ```Егор Алла Александр```: 
        ```regexp
        А.+а
        ```
        1. Перебирает последовательно символы в тексте, пока не встретит совпадение с ```A```
        1. Cверяет соответствие со вторым символом шаблона. В нашем случае это ```.``` - любой символ
        1. Берет по очереди следующий символ из строки и проверяет его на соответствие шаблону, до тех пор, пока будет выполняться условие «любой символ»
        1. После того как Matcher дошел до конца текста и закончил проверку для части шаблона ```А.+```, Matcher начинает проверку для оставшейся части шаблона – символ буквы ```а```. Так как текст в прямом направлении закончился, проверка происходит в обратном направлении, начиная с последнего символа
        1. Совпадение = ```Алла Алекса```
        
+ **Сверхжадный режим** - работа матчера аналогична механизму жадного режима. 
Отличие состоит в том, что при захватывании текста до конца строки поиск в обратном направлении не происходит.
    + Пример поиска в строке ```Егор Алла Александр```: 
        ```regexp
        А.++а
        ```
        1. Этап аналогичен жадному режиму
        1. Этап аналогичен жадному режиму
        1. Этап аналогичен жадному режиму
        1. После того как Matcher дошел до конца текста и закончил проверку для части шаблона ```А.+```,  матчер добавляет остаток шаблона и сравнивает с захваченной строкой
        1. Совпадений не найдего

+ **Ленивый режим** - ищется самое короткое совпадение в тексте
    + Пример поиска в строке ```Егор Алла Александр```: 
        ```regexp
        А.+?а
        ```
        1. Этап аналогичен жадному режиму
        1. Этап аналогичен жадному режиму
        1. После нахождения совпадения со вторым символом шаблона, который задан точкой и соответствует любому символу, Matcher будет проверять соответствие текста остатку шаблона – символу ```а```
        1. Если нашлось совпадение и конец текста не достигнут, то проверка начинается с поиска первого символа шаблона по аналогичному алгоритму и далее повторяется вплоть до окончания текста.
        1. Совпадения = ```Алла```, ```Алекса```
        
+ Отличия режимов в кратце:
    + Имеется строка ```aaaaa"aaaabbbb"ab"aaaacccccc"ba"aaaaaaaaa```
    + Жадный Regex ```"[ab"]+"``` 
    + Ленивый Regex ```"[ab"]+?"```
    + Жадный проходит по всем совпадениям диапазона ```[ab"]``` и 
        доходит до символа ```c``` не соответствующего диапазону. 
        Затем начинает возвращаться сверяя на каждом шаге с остатком шаблона ```"```. 
        1ое совпадение найдено - ```"aaaabbbb"ab"```,
         ищем другие с текущей позиции.
        + В итоге результат такой: ```"aaaabbbb"ab"```, ```"ba"```
    + Ленивый проходит по всем совпадениям диапазона ```[ab"]``` сверяя на каждом шаге
        с остатком шаблона ```"```. На вторых ковычках имеем 1ое совпадение - ```"aaaabbbb"```, 
        ищем другие с текущей позиции.
        + В итоге результат такой: ```"aaaabbbb"```, ```"ba"```
    + Сверхжадный  аналогичен жадному, за исключением того, что выполняет только одну попытку найти самое длинное совпадение, 
        в то время как жадный может выполнять несколько попыток. 
        + Подробнее: У сверхжадного отсутствует бэктрекинг (возврат назад) - 
            это полезно для оптимизации, бэктрекинг может сильно замедлить вычисление regexp,
            в основном из-за сверхмноговариативности (чаще всего при сочетани + и *)

## Примеры
+ Валидация email:
    ```regexp
    ^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}$
    ```
    где:
    + ```^``` - начало строки,
    + ```[]+``` - один или более символов из следующего набора:
        + ``` A-Z0-9._%+-``` - от `A` до `Z` или от `0` до `9` или `.` или `_` или `%` или `+` или `-`
    + ```@```
    + ```[]+``` - один или более символов из следующего набора:
        + ```[A-Z0-9.-]``` -  от `A` до `Z` или от `0` до `9` или `.` или `-`
    + ```\.``` - символ `.`
    + ```[A-Z]{2,6}``` - от 2 до 6 любых символов от `A` до `Z`
    + ```$``` - конец строки
    